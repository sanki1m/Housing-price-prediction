# -*- coding: utf-8 -*-
"""ML_housing.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DVuVhZ6Nvnmyu8m-bEQ7WQL6UgwmlMVs
"""

import numpy as np
import pandas as pd
from sklearn import linear_model
from sklearn.model_selection import train_test_split

from sklearn.datasets import fetch_california_housing
california=fetch_california_housing()

print(california)

df_x=pd.DataFrame(california.data,columns=california.feature_names)
df_y=pd.DataFrame(california.target)

df_x.describe()

reg=linear_model.LinearRegression()

x_train,x_test,y_train,y_test=train_test_split(df_x,df_y,test_size=0.2,random_state=4)

reg.fit(x_train,y_train)

reg.coef_

a=reg.predict(x_test)

a[6]

y_test

np.mean((a-y_test)**2)

